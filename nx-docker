#!/bin/bash

# Ensure the script exits on error
set -e

# Get the current working directory
WORKDIR=$(pwd)
IMAGE_NAME="nx-docker:latest"

if ! docker image inspect $IMAGE_NAME > /dev/null 2>&1; then
  echo "Docker image $IMAGE_NAME not found. Building it..."
  docker build -t $IMAGE_NAME .
fi

# Run the Nx command inside the Docker container
docker run --rm -it \
  -v "$WORKDIR:/workspace" \
  -v /var/run/docker.sock:/var/run/docker.sock \
  -w /workspace \
  $IMAGE_NAME "$@"
