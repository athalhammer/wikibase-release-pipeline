services:
  default:
    image: ${IMAGE_REGISTRY:+${IMAGE_REGISTRY}/}${IMAGE_NAMESPACE?}:/${IMAGE_NAME?}:${IMAGE_VERSION?}
    build:
      args:
        - PHP_IMAGE_URL
        - COMPOSER_IMAGE_URL
        - MEDIAWIKI_VERSION
        - WIKIBASE_COMMIT
        - BABEL_COMMIT
        - CLDR_COMMIT
        - CIRRUSSEARCH_COMMIT
        - ELASTICA_COMMIT
        - ENTITYSCHEMA_COMMIT
        - OAUTH_COMMIT
        - UNIVERSALLANGUAGESELECTOR_COMMIT
        - WIKIBASECIRRUSSEARCH_COMMIT
        - WIKIBASEMANIFEST_COMMIT
        - WIKIBASEEDTF_COMMIT
        - WIKIBASELOCALMEDIA_COMMIT
      tags:
        - ${IMAGE_REGISTRY:+${IMAGE_REGISTRY}/}${IMAGE_NAMESPACE?}/${IMAGE_NAME?}:latest
        - ${IMAGE_REGISTRY:+${IMAGE_REGISTRY}/}${IMAGE_NAMESPACE?}/${IMAGE_NAME?}:${IMAGE_VERSION_MAJOR?}
        - ${IMAGE_REGISTRY:+${IMAGE_REGISTRY}/}${IMAGE_NAMESPACE?}/${IMAGE_NAME?}:${IMAGE_VERSION_MINOR?}
        - ${IMAGE_REGISTRY:+${IMAGE_REGISTRY}/}${IMAGE_NAMESPACE?}/${IMAGE_NAME?}:mw${MEDIAWIKI_VERSION?}
